# 과대적합 / 과소적합

# Train / Validation set

# 모뎉체크포인트

# 이미지 데이터 전처리



# 원핫인코딩 ( one hot encoding )
```
    구분    봄  여름    가을    겨울
    봄	    1   0	    0	    0
    여름    0	1	    0	    0
    가을	0	0	    1	    0
    겨울	0	0	    0	    1

    [1, 0, 0, 0]
    [0, 1, 0, 0]
    [0, 0, 1, 0]
    [0, 0, 0, 1]
```

# 활성함수 ( activation function )
```
    선형함수
    비선형함수
    --------------------

    --------------------
    선형함수
    비선형함수    

    함수의 종류
        선형함수의 종류   
            dense
        비선형 함수의 종류
            relu, sigmoid, softmax

    참고
        텐서플로우 공식 도큐먼트
        https://www.tensorflow.org/api_docs/python/tf/keras/activations


    model = tf.keras.models.Sequential([
        tf.keras.layers.Flatten( input_shape=(28, 28)),
        tf.keras.layers.Dense(512),
        tf.keras.layers.ReLU(),
        tf.keras.layers.Dense(128),
        tf.keras.layers.ReLU(),
        tf.keras.layers.Dense(64),
        tf.keras.layers.ReLU(),
        tf.keras.layers.Dense(32),
        tf.keras.layers.ReLU(), 
        tf.keras.layers.Dense(10),
        tf.keras.layers.Softmax(), 
    ])

    model = tf.keras.models.Sequential([
        tf.keras.layers.Flatten( input_shape=(28, 28)),
        tf.keras.layers.Dense(512, activation='relu'),
        tf.keras.layers.Dense(256, activation='relu'),
        tf.keras.layers.Dense(128, activation='relu'),
        tf.keras.layers.Dense(64, activation='relu'),
        tf.keras.layers.Dense(32, activation='relu'),
        tf.keras.layers.Dense(10, activation='softmax'),
    ])


    model = tf.keras.models.Sequential([
        tf.keras.layers.Flatten( input_shape=(28, 28)),
        tf.keras.layers.Dense(512, activation='relu'),
        tf.keras.layers.Dense(256, activation='relu'),
        tf.keras.layers.Dense(128, activation='relu'),
        tf.keras.layers.Dense(64, activation='relu'),
        tf.keras.layers.Dense(32, activation='relu'),
        tf.keras.layers.Dense(10, activation='sigmoid'),
    ])    
```

# 분류 - 출력층 활성함수와 Loss 설정
```
    원핫인 경우     : categorical_crossentropy
    원핫이 아닌 경우 : sparse_categorical_crossentropy

    마지막 출력 층                      Loss
    Dense(1, activation='sigmoid')      loss='binary_crossentropy'
    Dense(2이상, activation='softmax')  loss='categorical_crossentropy'
                                        loss='sparse_categorical_crossentropy'

```

# 실습
```python
    # 기본모듈 임포트 + 추가 모듈
    import numpy as np
    import matplotlib.pyplot as plt
    import tensorflow as tf             

    from tensorflow.keras.layers import Dense, Flatten
    from tensorflow.keras.models import Sequential
    from tensorflow.keras.callbacks import ModelCheckpoint

    # 데이터 전처리 
    fashion_mnist = tf.keras.datasets.fashion_mnist
    (x_train, y_train), (x_valid, y_valid) = fashion_mnist.load_data()    

    # 값 확인 
    x_train_shape, x_valid_shape
    y_train_shape, y_valid_shape

    # 이미지 normalization  ( x 값에 대해서만 한다. )
    # 적용 전 최소 / 최대값 확인
    x_train.min(), x_train.max()   
    x_train = x_train / 255.0
    x_valid = x_valid / 255.0
    # 적용 후  최소 / 최대값 확인
    x_train.min(), x_train.max()

    # 모델정의  ( 샘플 데이터 시각화 )
    fig, axes = plt.subplots(2, 5)
    fig.set_size_inches(10, 5)

    for i in range(10):
        axes[i//5, i%5].imshow(x_train[i], cmap='gray')
        axes[i//5, i%5].set_title(str(y_train[i]), fontsize=15)
        plt.setp( axes[i//5, i%5].get_xticklabels(), visible=False)
        plt.setp( axes[i//5, i%5].get_yticklabels(), visible=False)
        axes[i//5, i%5].axis('off')

    plt.tight_layout()
    plt.show()
    # model.summary()

    # 모델생성
    model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['acc']) 

    # 학습

    # 검증

```